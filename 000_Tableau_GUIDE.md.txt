連接excel => 拖曳 excel sheet 至中央
=>下方點選工作表 => 即可進入 tableau 編輯圖表

最常用的data:ex02 Red30TechData.xlsx
練習資料表關聯:differentnames.xlsx

01 01 download Tableau
Support link => download Tableau

Public tableau => Free, not for business

01 02 Install drivers

tableau.com/support/drivers

01 03 Tableau file types

Tableau workbook (.twb)
Tableau data source (.tds)
- stores the server address, password, and 
other info required to access a data source
Tableau bookmark (.tbm)
- stores a connection to a worksheet in another Tableau workbook
Tableau extrace (.tde)
- stores tableau data as a filtered and aggregated extract
Tableau packaged workbook (.twbx)
- stored extracted data and visualizations for viewing in Tableau or Tableau reader

01 04 Get help in tableau

最上方 help => open help

01 05 new features

ch2 managing data sources and visualizations

02 01 connect to a data source
連接excel檔案

左方connect面板=>to a file=>Microsoft excel
打開 ex02 Red30TechData
可以發現我們的excel在左方只有一個sheet 

按下方 sheet1
將左方的Dimensions的Prod category拖到rows
Measures 的Order total拖到columns

02 02 Joining related data sources
JOIN兩個有相同欄位的excel

左方connect面板=>to a file=>Microsoft excel
打開 ex02 orders

左方connections白面板=>ADD
=>出現add a connection
再按一次microsoft excel
打開ex02 products

出現shee1 -OO- sheet1
點擊join發現 兩邊都有 product ID這一欄 所以可以join

按下方 sheet1
把上方product category 拖到 rows
把下方quantity 拖到中間的data area (abc abc)

可發現我們完成了一個表格

02 03 
Join data sources with inconsistent field names
JOIN兩個有不同欄位的excel 資料表關聯

左方connect面板=>to a file=>Microsoft excel
打開 ex02 differentnames.xlsx

左方發現兩個sheet customers和orders
把orders拖曳到中間 Drag sheets here
把customers也拖曳到中間 Drag sheets here

發現 -oo- 出現幾個選項
inner | left | right | full outer

我們要join "order ID"和 "cust ID"

一邊選取 "cust ID" 一邊選取 "order ID"

按下方 sheet1
把上方 customer state 拖到rows
把下方 rumber of records 拖到 abc abc
可發現我們完成了一個表格

02 04 clean up source data
處理有問題的excel來源檔案:例如處理大標題

連接cleandata.xlsx
發現有點問題
打開excel發現因為有一個大標題

你可以自己刪掉大標題或載入後
左方sheet白面板
use data intepreter打勾
他會自動調整 刪掉大標題

Tableau prep也可以清理data

02 05 reorder fields in a visualization

打開0205資料夾之範例
將左上方的prod category拖到rows
將左下方的order total拖到abc abc

將左上方的prod name也拖到rows
(類似pivot table)
把prod category拖到columns

02 06 change the summary operation

打開02_06 summary
rows只有一列prod category

左方marks標記面板 detail
有 Sum(order...)
按下倒三角形
選單measure度量 =>sum 總和
若改成average 則數字會改變成average


02 07 split text into multiple columns
分割和自訂分割
將一個欄位分割為2個欄位
例如 姓名 想分成姓和名 兩欄

在匯入資料表的頁面 有preview預覽資料的窗格
每一欄資料上方都有 藍色abc 右上角有三角形下拉選單
可以選擇 split分割
姓名(以空格分隔)就變成了兩欄

欄位-split1 欄位-split2
再按右上角有三角形下拉選單 可以rename重新幫欄位命名

右上角有三角形下拉選單 還有custom split自訂分割
可以客製化你要用什麼來分割這個欄位


02 08 present data using storylines
台上報告可以使用:檔案條=>故事=>新增本文

打開0208 storylines.twbx
最底部sheet條 工作表的右邊 有"new story button"
把左方story面板的sales by title sheet拖到中間
則新增了一個story point

中央 add a caption 可以加標題
story1也可以改成自己的標題

左方story面板 按 blank 新增新的story
重複拖進去並且重新命名caption

左方story面板 最下方 預設大小為1016x964
按下三角形可以調整大小


02 09 display source metadata

0209_metadata.twbx
進入datasource資料來源頁面
預覽窗格的上方 sort fields的左邊兩個小圖示
的右邊 manage metadata(管理員資料)

點第一個 再捲到最後一個點shift
全選data後可以copy到新的excel

02 10 join related data sources(更新)
關連兩個有欄位相同的資料表

打開customers.xlsx
再打開orders.xlsx
兩者連接
2020.2版要手動拖曳進去建立關聯

02 11 join data sources with inconsistent field names(更新)
關連兩個欄位不同名稱的資料表

舊版
differentnames.xlsx
sheets拖進中間並建立關聯
customer id = cust id
2020.2版本
也是這樣 沒有改很多


03 managing Tableau worksheets and workbooks
03 01 display the data underlying a workbook
查看圖表的原始資料

file條的data menu(資料)
打開最底的red30techdata(資料名稱自訂)=>第三個欄位view data(檢視資料)

滑鼠拖曳可以選擇資料
按下ctrl可以選擇不連續的資料
往下捲並點擊一欄shift可以選擇很長一欄資料
按欄位名稱 即可sort data

export可匯出(要錢)

03 02 add, duplicate and rename worksheets

右上角show me (顯示)按鈕就是畫圖的panel
點擊打開或隱藏

新增worksheet => 類似excel那樣 下方+號 可新增worksheet
點兩下可重新命名

複製工作表也是跟excel一樣 右鍵=>duplicate(重複)

03 03 reorder, clear, and delete worksheets

清空工作表
=>file條=>worksheet工作表=>clear清除=>sheet工作表

刪除工作表(跟excel一樣)=>點擊下方工作表右鍵=>刪除

03 04 change a worksheet's tab color
工作表tab可以換顏色
=>工作表名稱右鍵=>換顏色

03 05 show or hide worksheet elements
為工作區騰出空間

儀錶板上的東西例如 marks 都可以按上方的三角型藏起來(隱藏卡)
如果想要這些東西回來
worksheet工作表=>show cards顯示卡 => reset cards重設卡

worksheet工作表=>show caption顯示說明文字=>會出現AI自動說明這些資料在做甚麼

資料儀錶板也能藏起來
他會藏到最左下角 很難發現 但點擊他的三角形就會回來

03 06 save your changes
"revert to save" is only available for .twb
not for .twbx

03 07 save your workbook as a pdf file(要錢)
檔案=>存成pdf 
show selections:顯示你點擊的東西

03 08 create a packaged workbook(要錢)
file=>export packaged workbook=>save as .twbx

03 09 export data to a csv file
file條data資料=>你的檔名=>export as csv將資料匯出為csv

03 10 export visualization to powerpoint(要錢)
檔案=>export as powerpoint


04. Create Custom Calculations and Fields
04 01 Present Tableau operators and built-in functions

+:addition(包括日期), 字串串接
-:subtraction(包括日期), negation
*:乘
/:除
%:餘數
^:指數
=:一個等於就是等於
<>:不等於
SUM, AVG, MIN, MAX
STDEV=標準差
ABS=絕對值
CEILING=無條件四捨五入至整數 rounds a number up to the next integer(4.01會變成5)
FLOOR=無條件四捨五入捨去至整數 (4.99會變4)
ROUND=四捨五入


0402 Create a calculated field
計算數值

file條
analysis分析=>下方create calculated field建立導出欄位

給他一個名字 total sales
[Price]*[Quantity]
左下角the calculation is valid
按ok

表格區就出現了一欄叫做 total sales

若不滿意這個名字 就按左邊工作表
三角形或右鍵=>rename 重新命名
三角形或右鍵=>edit 修改公式
三角形或右鍵=>delete 刪除

0403 Create a calculated field on a shelf
直接在欄裡做計算

在中間欄的column裡面點兩下 打入
[Price]*[Quantity]
(不用打=)

還可以拖到左方欄 新增一個欄
並更名做total sales

按esc以跳出選取

0404 Add a table calculation
新增表計算(須複習)

檢查左方的mark標記卡
會發現計算方式是sum
按三角形
找到quick table calculation
選running total

mark標記卡的sum
按三角形
找到edit table calculation 編輯表計算

mark標記卡的sum
按三角形
找到clear table calculation清空表計算

mark標記卡的sum
按三角形
按下add table calculation(新增表計算)
出現對話框
上方預設為difference from(差異)
下拉選單有其他選項
中間選擇table(down)
最下方選擇related to=>previous
打勾show calculation assistance

mark標記卡的sum
按三角形
按下edit table calculation 編輯表計算
編輯對話框
上方選擇percent of total
中間選擇table across
最下方選擇related to=>previous
打勾show calculation assistance

mark標記卡的sum
按三角形
找到clear table calculation清空表計算
data 回復原狀


0405 Use level of detail expressions
(可複習)

difference from average
在欄上打
[order total] - {AVG(order total)}

0406 Create calculations in dialog boxes
(可複習filters)

按中間的列=>三角形=>filter篩選條件
出現對話框
找到第三個tab=>condition tab條件
選擇中間的by formula按公式
鍵入
[prod catagory] >="eBooks"
數據就變了

取消打勾by formula 數據又回來了

5. Analyze Data
0501
Calculate averages, medians, minimums, and maximums
計算中位數 平均 最大值和最小值

選取資料拖到中間的shlf
sales by region列rows shelf
order total欄column shelf

標記卡的sum total三角形
=>measure(度量)
=>按下average
=>就變成average order total

可以再把左方的order total拖進來
(預設為sum)
現在就有三欄了

median中位數:
=>measure(度量)
=>按下中位數

maximum 最大值
=>measure(度量)
=>按下最大值


0502
Count occurrences and distinct items
(可複習)
計算每個類別一共對應到幾個值
例如每個prod catagory都對應到幾個銷售量

analysis分析=>create calculation field
命名為distinct products
對話框裡面打入
COUNTD([prod name])




0503
Display the Summary Card

sales totals欄
employee job title列

file條=>worksheet工作表=>show summary
右方出現summary卡

 簡單敘述了平均 中位數 最大最小值等

上方toolbar條 可以sort data

0504
Calculate percentages within a table
計算百分比
例如計算每個職位對銷售額占的百分比

file條
Analysis=>percentage of=>column

file條
Analysis=>percentage of=>pane(意思是表中央以粗直線分割的每個版面)

file條
Analysis=>percentage of=>none 清除

0505
Forecast future values
(可複習)

先讓中間出現折線圖

左方資料面板
有analytics分析面板 切換到analytics分析面板
Model模型=>forecast趨勢預測
拖到中間圖

圖會出現預測以及信賴區間

中間欄的三角形=>more更多=>custom自訂
會出現一個對話框
create a custom date for this field
選擇date value


6. Sort and Filter Tableau Data
0601
Sort based on a field's values

toolbar條=>工具列有遞增遞減排序的按鈕

或是你按中間欄/列的三角形選單
=>也有sort按鈕
會出現詳細的對話框

詳細對話框可以設定依照什麼來排序
sort by field 設定依照欄位名稱排序
(可依照字母 欄位數值 巢狀 等排序法)
=>descending
field name=>鍵入你要依照他排序的欄位名稱例如
number of records
aggregation=>設定為sum (其他有中位數等等排序法)

就算欄位沒出現在上面 
依然可以用沒拖進去的欄位來排序

清除排序
=>中間欄三角形選單=>clear sort清除

0602 create a multilevel sort
多項的排序 有兩個欄位以上的排序

範例
欄位sales region 欄位2 prod category
對應到數值sales

我們現在想照prod category來排序
欄位sales region不動
=>去欄位2 prod category 三角形選單
按sort排序
選擇nested巢狀/descending遞減/field name欄位名稱:order total/aggregation彙總:sum

0603
Create a selection filter篩選

中間欄位三角形(例如prod category)
=>filter
出現對話框
可以勾選你想看到的項目
exclude是相反 勾選你不想看到的項目

0604
Create a wildcard filter
依照包含的字詞來篩選

中間欄位三角形=>filter篩選
出現對話框
對話框第二個tab wildcard tab萬用字元
輸入字串
選項有
contains/start with/end with/exact match
還有exclude(排除) 可以選 (變成不包含)

按clear 清除
則data回來

0605
Create a condition filter
條件篩選 例如只傳回銷售值低於多少的資料

中間欄位三角形=>filter篩選
出現對話框
第三個condition tab(條件)

選擇by field
範例中
Quantity欄位已選取 
因為你是點quantity欄位的欄位三角形
接下來可以設定大於小於
按下load button 會先給最大值和最小值
讓我們知道在看哪個欄位

若要清除篩選
就點最上面的none 
filter就會被清除

0606
Create a top filter
選前幾高或前幾低的欄位

本範例中央是一個tree map

萬一欄位上沒東西怎麼辦
從左邊把要分析的欄位拖到左邊的 filter卡(篩選條件卡)
就會開啟 filter對話框

按第四個 top tab
選取 by field
選top 鍵入3
選order total (欄位自訂)
選sum

會發現tree map
剩下三個order total (欄位自訂)
最高的region

若是選bottom鍵入2
tree map剩下兩個order total (欄位自訂)
最低的region

要清除就從左邊把要分析的欄位拖到左邊的 filter卡
按下non即可清除

0607
Edit, clear, and delete filters

篩選條件卡 => 三角形選單
編輯篩選條件(選none來清除篩選)

或是上方的欄位或列=>三角形選單=>編輯篩選條件(選none來清除篩選)

清除全部的篩選條件
workbook工作表=>clear清除=>filters篩選條件
會清除掉全部的篩選條件

一個個清除=>篩選條件卡=>將要清除的篩選條件
拖曳到左方放資料的
dimension tab
拖掉這個tab就會清除篩選條件卡

0608
Show or hide sorting controls

中間資料圖表也有欄位名稱 上方有三角形
跟excel一樣 可以直接點欄位來建立篩選

如果不要或要這個功能就去
workbook=>show sort controls(顯示排序控制項)
=>關閉或開啟

0609
Filter data using parameters
(可複習)(較少用)(免費版不太一樣)
parameter based filter

去左方dimension tab的資料
找到order total欄位
右鍵=>create建立=>parameter參數

給這個參數一個名字叫做parameter filter
datatype:integer (float改成integer)
current value:4
allowable values:選range
range of value:min:4 改成2
max:83885 改成7
step size:(若是2就會是1 3 5 7)此處不動

左邊data出現新欄位:
你的parameter filter

去左方dimension tab的資料
找到order total欄位
拖進篩選卡
對話框的第四個tab 建立top filter
選by field
選top 
選你的parameter filter

左邊data
選你的parameter filter
右鍵
show parameter control顯示參數

右邊會出現面板
拖曳即可決定你的tree map有幾欄
本範例會是2到7欄
(免費版略有不同)

0610
Edit and delete parameters
(較少用 可複習)(免費版略有不同)

承上個範例
左邊data
你的parameter filter
右鍵編輯parameter
右鍵show parameter control顯示參數
也可以右鍵delete

7. Define Groups and Sets
0701
Define a group
組成群組 例如一個公司併購了另一個

去中間資料表位
選擇A公司 ctrl B公司
會跳出工具箱 
按工具箱裡面的group members
組成群組


0702
Define a group for other values


0703
Find members of a group


0704
Edit and delete groups


0705
Define a set


0706
Create summaries using sets


0707
Combine sets


0708
Edit and delete sets

8. Develop and Pivot Crosstabs
0801
Develop a crosstab


0802
Unpivot a crosstab


0803
Add totals and subtotals to a crosstab




9. Create Basic Visualizations
0901
Create column and stacked column charts


0902
Build line charts and area fill charts


0903
Develop pie charts


0904
Create scatter plots


0905
Identify data clusters


0906
Create histograms


0907
Summarize data using a smart histogram


0908
Make a treemap




10. Format Tableau Visualizations
1001
Change the visual summary type


1002
Change the appearance of your data


1003
Resize a visualization


1004
Display a visualization in Presentation mode


1005
Create a highlight table


1006
Display a viz in a tooltip

11. Annotate and Format Visualizations
1101
Annotate a visualization


1102
Format chart elements


1103
Add a trend line to a chart


1104
Add reference lines, distributions, and boxes

12. Map Geographic Data
1201
Create a basic map


1202
Add and remove map layers


1203
Enhance map analysis using distance 



1204
measurement tools


1205
Disable pan and zoom in maps


1206
Define custom regions

13. Build Dashboards and Actions
1301
Build a dashboard


1302
Arrange and resize dashboard elements


1303
Define a filter action


1304
Define a highlight action


1305
Define a URL action




14. Tableau 2019.2 Updates
1401
Show or hide sorting controls


1402
Create maps using vector images


1403
Quickly replace a worksheet in a dashboard


1404
Define parameter actions



15
Conclusion
Next steps


Source:
Tableau Essential Training (2020.1)
